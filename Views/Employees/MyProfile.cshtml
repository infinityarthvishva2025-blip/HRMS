@model HRMS.Models.Employee

@{
    ViewData["Title"] = "My Profile";
    Layout = "~/Views/Shared/_EmployeeLayout.cshtml";
    string baseFolder = Url.Content("~/uploads/employees/" + Model.EmployeeCode + "/");
}

<div class="container py-4">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="fw-bold text-primary">
            <i class="fa-solid fa-id-card me-2"></i> My Profile
        </h3>

        
    </div>

    <!-- Reuse Details-style layout but slightly more compact -->
    <div class="card shadow-sm border-0 p-4 mb-4">
        <div class="row">
            <div class="col-md-3 text-center">
                @if (!string.IsNullOrEmpty(Model.ProfileImagePath))
                {
                    var profileUrl = baseFolder + Model.ProfileImagePath;
                    var ext = System.IO.Path.GetExtension(Model.ProfileImagePath)?.ToLower();
                    if (ext == ".jpg" || ext == ".jpeg" || ext == ".png" || ext == ".gif" || ext == ".bmp" || ext == ".webp")
                    {
                        <img src="@profileUrl" class="img-thumbnail mb-3" style="max-height:180px;" alt="Profile Photo" />
                    }
                    else
                    {
                        <a href="@profileUrl" target="_blank" class="btn btn-sm btn-outline-secondary mb-3">
                            View / Download Photo
                        </a>
                    }
                }
                else
                {
                    <div class="border rounded p-4 text-muted">No Photo</div>
                }

                <h5 class="mt-2">@Model.Name</h5>
                <p class="mb-1 text-muted">Employee Code: <strong>@Model.EmployeeCode</strong></p>
                <p class="mb-0"><span class="badge bg-primary">@Model.Role</span></p>
            </div>

            <div class="col-md-9">
                <h5 class="fw-bold text-secondary mb-3">Basic & Contact Details</h5>
                <div class="row g-2">
                    <div class="col-md-4">
                        <strong>Email:</strong><br /> @Model.Email
                    </div>
                    <div class="col-md-4">
                        <strong>Mobile:</strong><br /> @Model.MobileNumber
                    </div>
                    <div class="col-md-4">
                        <strong>Alternate Mobile:</strong><br /> @(string.IsNullOrEmpty(Model.AlternateMobileNumber) ? "-" : Model.AlternateMobileNumber)
                    </div>
                    <div class="col-md-4">
                        <strong>Gender:</strong><br /> @(string.IsNullOrEmpty(Model.Gender) ? "-" : Model.Gender)
                    </div>
                    <div class="col-md-4">
                        <strong>DOB:</strong><br /> @(Model.DOB_Date?.ToString("dd-MMM-yyyy") ?? "-")
                    </div>
                    <div class="col-md-4">
                        <strong>Marital Status:</strong><br /> @(string.IsNullOrEmpty(Model.MaritalStatus) ? "-" : Model.MaritalStatus)
                    </div>
                </div>

                <hr />

                <h5 class="fw-bold text-secondary mb-2">Address</h5>
                <p class="mb-1">
                    <strong>Current Address:</strong><br />
                    @(string.IsNullOrEmpty(Model.Address) ? "-" : Model.Address)
                </p>
                <p class="mb-0">
                    <strong>Permanent Address:</strong><br />
                    @(string.IsNullOrEmpty(Model.PermanentAddress) ? "-" : Model.PermanentAddress)
                </p>
            </div>
        </div>
    </div>

    <div class="card shadow-sm border-0 p-4 mb-4">
        <h5 class="fw-bold text-secondary mb-3">Job Details</h5>

        <div class="row g-3">
            <div class="col-md-4">
                <strong>Joining Date:</strong><br />
                @(Model.JoiningDate?.ToString("dd-MMM-yyyy") ?? "-")
            </div>
            <div class="col-md-4">
                <strong>Department:</strong><br />
                @(string.IsNullOrEmpty(Model.Department) ? "-" : Model.Department)
            </div>
            <div class="col-md-4">
                <strong>Position:</strong><br />
                @(string.IsNullOrEmpty(Model.Position) ? "-" : Model.Position)
            </div>
            <div class="col-md-4">
                <strong>Reporting Manager:</strong><br />
                @(string.IsNullOrEmpty(Model.ReportingManager) ? "-" : Model.ReportingManager)
            </div>
            <div class="col-md-4">
                <strong>Salary:</strong><br />
                @(Model.Salary.HasValue ? Model.Salary.Value.ToString("0.00") : "-")
            </div>
        </div>
    </div>

    <div class="card shadow-sm border-0 p-4 mb-4">
        <h5 class="fw-bold text-secondary mb-3">Emergency & Health</h5>

        <div class="row g-3">
            <div class="col-md-4">
                <strong>Emergency Contact Name:</strong><br />
                @(string.IsNullOrEmpty(Model.EmergencyContactName) ? "-" : Model.EmergencyContactName)
            </div>
            <div class="col-md-4">
                <strong>Relationship:</strong><br />
                @(string.IsNullOrEmpty(Model.EmergencyContactRelationship) ? "-" : Model.EmergencyContactRelationship)
            </div>
            <div class="col-md-4">
                <strong>Emergency Mobile:</strong><br />
                @(string.IsNullOrEmpty(Model.EmergencyContactMobile) ? "-" : Model.EmergencyContactMobile)
            </div>
            <div class="col-md-12">
                <strong>Emergency Address:</strong><br />
                @(string.IsNullOrEmpty(Model.EmergencyContactAddress) ? "-" : Model.EmergencyContactAddress)
            </div>
        </div>

        <hr />

        <div class="row g-3">
            <div class="col-md-4">
                <strong>Has Disease:</strong><br />
                @(string.IsNullOrEmpty(Model.HasDisease) ? "-" : Model.HasDisease)
            </div>
            <div class="col-md-4">
                <strong>Disease Name:</strong><br />
                @(string.IsNullOrEmpty(Model.DiseaseName) ? "-" : Model.DiseaseName)
            </div>
            <div class="col-md-4">
                <strong>Disease Since:</strong><br />
                @(string.IsNullOrEmpty(Model.DiseaseSince) ? "-" : Model.DiseaseSince)
            </div>
            <div class="col-md-4">
                <strong>Medicines Required:</strong><br />
                @(string.IsNullOrEmpty(Model.MedicinesRequired) ? "-" : Model.MedicinesRequired)
            </div>
            <div class="col-md-4">
                <strong>Doctor Name:</strong><br />
                @(string.IsNullOrEmpty(Model.DoctorName) ? "-" : Model.DoctorName)
            </div>
            <div class="col-md-4">
                <strong>Doctor Contact:</strong><br />
                @(string.IsNullOrEmpty(Model.DoctorContact) ? "-" : Model.DoctorContact)
            </div>
        </div>

        @if (!string.IsNullOrEmpty(Model.MedicalDocumentFilePath))
        {
            var url = baseFolder + Model.MedicalDocumentFilePath;
            var ext = System.IO.Path.GetExtension(Model.MedicalDocumentFilePath)?.ToLower();

            <hr />
            <h6 class="fw-bold">Medical Document</h6>

            if (ext == ".jpg" || ext == ".jpeg" || ext == ".png" || ext == ".gif" || ext == ".bmp" || ext == ".webp")
            {
                <img src="@url" class="img-thumbnail" style="max-height:150px;" alt="Medical Document" />
            }
            else
            {
                <a href="@url" target="_blank" class="btn btn-sm btn-outline-secondary mt-1">
                    View / Download
                </a>
            }
        }

    </div>

</div>
