@model HRMS.Models.ViewModels.PayrollSummaryVm
@{
    Layout = "~/Views/Shared/_HrLayout.cshtml";
}

<div id="payslip-content" class="container mt-4 bg-white shadow-lg rounded p-5">

    <!-- Company Header -->
    <div class="d-flex justify-content-between align-items-center border-bottom pb-3 mb-4">
        <div class="d-flex align-items-center">
            <img src="~/images/infinity-logo.png" alt="Infinity Arthvishva Logo" style="height:80px; width:auto; margin-right:15px;">
            <div>
                <h3 class="fw-bold text-primary mb-0">Infinity Arthvishva</h3>
                <small class="text-muted">Empowering Finance & Innovation</small>
            </div>
        </div>

        <!-- ⭐ Fancy Download Button -->
        <div class="text-end">
            <button class="fancy-download-btn" onclick="downloadPayslip()">
                <i class="bi bi-download me-2"></i> Download Salary Slip
                <span class="shine"></span>
            </button>
            <h4 class="fw-bold text-success mb-1 mt-2">Salary Slip</h4>
            <span class="text-secondary">@Model.Month / @Model.Year</span>
        </div>
    </div>

    <!-- Employee & Bank Details -->
    <div class="row mb-4">
        <div class="col-md-6">
            <h5 class="fw-semibold text-primary">Employee Details</h5>
            <table class="table table-sm table-bordered mb-3">
                <tr><th style="width:40%">Employee Code</th><td>@Model.EmpCode</td></tr>
                <tr><th>Name</th><td>@Model.EmpName</td></tr>
                <tr><th>Department</th><td>@Model.Department</td></tr>
                <tr><th>Designation</th><td>@Model.Designation</td></tr>
            </table>
        </div>

        <div class="col-md-6">
            <h5 class="fw-semibold text-primary">Bank Details</h5>
            <table class="table table-sm table-bordered">
                <tr><th style="width:40%">Bank Name</th><td>@Model.BankName</td></tr>
                <tr><th>Account No.</th><td>@Model.AccountNumber</td></tr>
                <tr><th>IFSC Code</th><td>@Model.IFSCCode</td></tr>
                <tr><th>Branch</th><td>@Model.BankBranch</td></tr>
            </table>
        </div>
    </div>

    <!-- Attendance Summary -->
    <h5 class="fw-semibold text-primary mt-4">Attendance Summary</h5>
    <table class="table table-bordered table-striped w-100 mb-4">
        <thead class="table-light">
            <tr class="text-center fw-semibold">
                <th>Working Days</th>
                <th>Absent</th>
                <th>Late Marks</th>
                <th>Late Deduction Days</th>
                <th>Paid Days</th>
            </tr>
        </thead>
        <tbody class="text-center">
            <tr>
                <td>@Model.TotalDaysInMonth</td>
                <td>@Model.AbsentDays</td>
                <td>@Model.LateMarks</td>
                <td>@Model.LateDeductionDays</td>
                <td class="fw-bold">@Model.PaidDays</td>
            </tr>
        </tbody>
    </table>

    <!-- Salary Summary -->
    <h5 class="fw-semibold text-primary mt-4">Salary Summary</h5>
    <table class="table table-bordered table-hover w-100 mb-4">
        <tbody>
            <tr><th>Base Salary</th><td>@Model.MonthlySalary.ToString("0.00")</td></tr>
            <tr><th>Per Day Salary</th><td>@Model.PerDaySalary.ToString("0.00")</td></tr>
            <tr><th>Gross Salary</th><td>@Model.GrossSalary?.ToString("0.00")</td></tr>
            <tr><th>Performance Allowance</th><td>@Model.PerformanceAllowance?.ToString("0.00")</td></tr>
            <tr><th>Other Allowances</th><td>@Model.OtherAllowances?.ToString("0.00")</td></tr>
            <tr><th>Petrol Allowance</th><td>@Model.PetrolAllowance?.ToString("0.00")</td></tr>
            <tr><th>Reimbursement</th><td>@Model.Reimbursement?.ToString("0.00")</td></tr>
            <tr><th>Professional Tax</th><td>@Model.ProfessionalTax?.ToString("0.00")</td></tr>
            <tr class="table-danger"><th>Total Deductions</th><td>@Model.TotalDeductions?.ToString("0.00")</td></tr>
            <tr class="table-success fw-bold fs-5">
                <th>NET SALARY</th>
                <td>@Model.NetSalary?.ToString("0.00")</td>
            </tr>
        </tbody>
    </table>

    <!-- Footer -->
    <div class="mt-5 text-center border-top pt-3">
        <p class="mb-0 fw-semibold">This is a computer-generated payslip and does not require a signature.</p>
        <small class="text-muted">© @DateTime.Now.Year Infinity Arthvishva | All Rights Reserved</small>
    </div>
</div>

<!-- ⭐ Dynamic Filename JS -->
<script>
    function downloadPayslip() {
        const originalTitle = document.title;
        document.title = `SalarySlip_@Model.EmpCode${@Model.Month}_${@Model.Year}`;
        window.print();
        setTimeout(() => { document.title = originalTitle; }, 1500);
    }
</script>

<!-- ⭐ Styling -->
<style>
    body {
        background-color: #f5f7fa;
        font-family: "Segoe UI", Roboto, sans-serif;
    }

    th {
        width: 40%;
        background-color: #f2f6ff;
    }

    h5 {
        border-left: 4px solid #007bff;
        padding-left: 8px;
    }

    /* --------------------------------------------------
           FANCY DOWNLOAD BUTTON
           -------------------------------------------------- */
    .fancy-download-btn {
        position: relative;
        background: linear-gradient(135deg, #007bff, #00c6ff);
        border: none;
        color: white;
        padding: 10px 18px;
        font-size: 14px;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
        overflow: hidden;
        transition: transform .2s ease;
    }

        .fancy-download-btn:hover {
            transform: scale(1.06);
        }

        .fancy-download-btn .shine {
            position: absolute;
            top: 0;
            left: -100%;
            width: 80%;
            height: 100%;
            background: rgba(255, 255, 255, 0.4);
            transform: skewX(-25deg);
            transition: 0.5s;
        }

        .fancy-download-btn:hover .shine {
            left: 120%;
        }

    /* Print Styling */
    @@media print {
        @@page {
            size: A4 portrait;
            margin: 15mm;
        }

        body * {
            visibility: hidden !important;
        }

        #payslip-content, #payslip-content * {
            visibility: visible !important;
        }

        .fancy-download-btn {
            display: none !important;
        }

        #payslip-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
        }
    }
</style>
