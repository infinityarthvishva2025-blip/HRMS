@model HRMS.Models.CelebrationViewModel
@using System.Linq
@{
    ViewData["Title"] = "Dashboard";
}

<!-- Dashboard Summary Cards -->
<div class="row">
    <div class="col-md-3 mb-3">
        <div class="card shadow-sm border-0 text-center">
            <div class="card-body">
                <i class="fa-solid fa-users fa-2x text-primary mb-2"></i>
                <h4 class="fw-bold mb-0">47</h4>
                <small>Total Employees</small>
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-3">
        <div class="card shadow-sm border-0 text-center">
            <div class="card-body">
                <i class="fa-solid fa-user-check fa-2x text-success mb-2"></i>
                <h4 class="fw-bold mb-0">42</h4>
                <small>Today's Present</small>
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-3">
        <div class="card shadow-sm border-0 text-center">
            <div class="card-body">
                <i class="fa-solid fa-location-dot fa-2x text-info mb-2"></i>
                <h4 class="fw-bold mb-0">35</h4>
                <small>Geo Tags Assigned</small>
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-3">
        <div class="card shadow-sm border-0 text-center">
            <div class="card-body">
                <i class="fa-solid fa-calendar-xmark fa-2x text-warning mb-2"></i>
                <h4 class="fw-bold mb-0">8</h4>
                <small>Pending Leaves</small>
            </div>
        </div>
    </div>
</div>

<!-- Celebrations + Chart Row -->
<!-- Celebrations + Chart Row -->
<div class="row mt-4">
    <!-- Celebrations Section (Left) -->
    <div class="col-lg-6 col-md-12 mb-4">
        <div class="card shadow-sm border-0 h-100">
            <div class="card-header bg-white fw-bold border-bottom">
                🎉 Celebrations
            </div>
            <div class="card-body">
                <div class="row">
                    <!-- Today's Celebrations -->
                    <div class="col-md-6 border-end">
                        <h6 class="fw-bold text-primary mb-3">Today's Celebrations</h6>

                        @if ((Model?.TodaysBirthdays?.Any() ?? false) || (Model?.TodaysAnniversaries?.Any() ?? false))
                        {
                            @foreach (var emp in Model.TodaysBirthdays)
                            {
                                <div class="d-flex align-items-center mb-2">
                                    <div class="icon bg-danger-subtle text-danger me-2">
                                        <i class="fa-solid fa-cake-candles"></i>
                                    </div>
                                    <div>
                                        <strong>@emp.Name</strong><br />
                                        <small class="text-muted">Birthday Today 🎂</small>
                                    </div>
                                </div>
                            }

                            @foreach (var emp in Model.TodaysAnniversaries)
                            {
                                <div class="d-flex align-items-center mb-2">
                                    <div class="icon bg-info-subtle text-info me-2">
                                        <i class="fa-solid fa-briefcase"></i>
                                    </div>
                                    <div>
                                        <strong>@emp.Name</strong><br />
                                        <small class="text-muted">@emp.Position 🎉</small>
                                    </div>
                                </div>
                            }
                        }
                        else
                        {
                            <div class="text-muted">No celebrations today 🎈</div>
                        }
                    </div>

                    <!-- Tomorrow's Celebrations -->
                    <div class="col-md-6">
                        <h6 class="fw-bold text-success mb-3">Tomorrow's Celebrations</h6>

                        @if ((Model?.TomorrowsBirthdays?.Any() ?? false) || (Model?.TomorrowsAnniversaries?.Any() ?? false))
                        {
                            @foreach (var emp in Model.TomorrowsBirthdays)
                            {
                                <div class="d-flex align-items-center mb-2">
                                    <div class="icon bg-danger-subtle text-danger me-2">
                                        <i class="fa-solid fa-cake-candles"></i>
                                    </div>
                                    <div>
                                        <strong>@emp.Name</strong><br />
                                        <small class="text-muted">Birthday Tomorrow 🎂</small>
                                    </div>
                                </div>
                            }

                            @foreach (var emp in Model.TomorrowsAnniversaries)
                            {
                                <div class="d-flex align-items-center mb-2">
                                    <div class="icon bg-info-subtle text-info me-2">
                                        <i class="fa-solid fa-briefcase"></i>
                                    </div>
                                    <div>
                                        <strong>@emp.Name</strong><br />
                                        <small class="text-muted">@emp.Position 🎊</small>
                                    </div>
                                </div>
                            }
                        }
                        else
                        {
                            <div class="text-muted">No celebrations tomorrow 🎉</div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Employee Distribution Chart (Right) -->
    <div class="col-lg-6 col-md-12 mb-4">
        <div class="card shadow-sm border-0 h-100">
            <div class="card-header bg-white fw-bold border-bottom">
                Employee Distribution by Department
            </div>
            <div class="card-body d-flex align-items-center justify-content-center">
                <canvas id="deptChart" height="250"></canvas>
            </div>
        </div>
    </div>
</div>

    

   

<!-- Chart.js Script -->
<!-- Chart.js Script -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('deptChart');

    const departmentLabels = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(ViewBag.DepartmentLabels));
    const departmentValues = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(ViewBag.DepartmentValues));

    new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: departmentLabels,
            datasets: [{
                label: 'Employees',
                data: departmentValues,
                backgroundColor: [
                    '#1976d2', // IT
                    '#009688', // HR
                    '#9c27b0', // Finance
                    '#f44336', // Marketing
                    '#ff9800', // Operations
                    '#00bfa5', // Sales
                    '#795548', // Others
                ],
                borderWidth: 2,
                borderColor: '#fff',
                hoverOffset: 6
            }]
        },
        options: {
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        boxWidth: 20,
                        padding: 15
                    }
                }
            },
            cutout: '65%',
            responsive: true,
            maintainAspectRatio: false
        }
    });
</script>


<!-- Celebration Styling -->
<style>
    .card {
        border-radius: 10px;
    }

    .card-header {
        font-size: 1.1rem;
        border-bottom: 1px solid #e0e0e0;
    }

    .celebration-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        background: rgba(0, 0, 0, 0.05);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .text-danger {
        color: #e53935 !important;
    }

    .text-info {
        color: #00838f !important;
    }

    .icon {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
    }

    .bg-danger-subtle {
        background-color: #ffe5e5 !important;
    }

    .bg-info-subtle {
        background-color: #e0f7fa !important;
    }

    .text-danger {
        color: #e53935 !important;
    }

    .text-info {
        color: #00838f !important;
    }

    .text-muted {
        font-size: 0.9rem;
    }

</style>
